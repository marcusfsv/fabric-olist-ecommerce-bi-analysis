-- Create a new dim_payment_type table
DROP TABLE IF EXISTS dim.dim_payment_type;

CREATE TABLE dim.dim_payment_type AS
SELECT
    DENSE_RANK() OVER (ORDER BY payment_type) AS payment_type_sk,  -- surrogate key
    payment_type
FROM (
    SELECT DISTINCT payment_type
    FROM stg.stg_order_payments
) s;